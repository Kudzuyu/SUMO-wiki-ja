
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://kudzuyu.github.io/SUMO-wiki-ja/Tools/Detector/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Detector - SUMO wiki ja</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="//fonts.googleapis.com/earlyaccess/notosansjp.css">
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:600,800">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#flowrouterpy" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../.." title="SUMO wiki ja" class="md-header__button md-logo" aria-label="SUMO wiki ja" data-md-component="logo">
      
  <img src="../../images/sumo-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SUMO wiki ja
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Detector
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="検索">
        
        <button type="reset" class="md-search__icon md-icon" title="クリア" aria-label="クリア" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="タブ" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  ドキュメント

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../Downloads/" class="md-tabs__link">
        
  
  
    
  
  ダウンロード

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../Publications/" class="md-tabs__link">
        
  
  
    
  
  出版物

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SUMO wiki ja" class="md-nav__button md-logo" aria-label="SUMO wiki ja" data-md-component="logo">
      
  <img src="../../images/sumo-logo.png" alt="logo">

    </a>
    SUMO wiki ja
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ドキュメント
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Downloads/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ダウンロード
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Publications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    出版物
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#input-files" class="md-nav__link">
    <span class="md-ellipsis">
      Input files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-vehicles-with-additional-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Generating vehicles with additional parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ambiguity" class="md-nav__link">
    <span class="md-ellipsis">
      Ambiguity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ambiguity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#distribution-among-candidate-successors" class="md-nav__link">
    <span class="md-ellipsis">
      Distribution among candidate successors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restricting-generated-routes" class="md-nav__link">
    <span class="md-ellipsis">
      Restricting generated routes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<p>This page documents tools that work with <a href="../../Simulation/Output/Induction_Loops_Detectors_%28E1%29/">detectors</a> and detector <a href="../../Demand/Routes_from_Observation_Points/#computing_flows">flow files</a>.</p>
<h1 id="flowrouterpy">flowrouter.py<a class="headerlink" href="#flowrouterpy" title="Permanent link">&para;</a></h1>
<p>"flowrouter.py" serves as a drop in replacement for
<a href="../../dfrouter/">dfrouter</a> which calculates a set of routes <strong>-o</strong> and
traffic flows <strong>-e</strong> from given detectors <strong>-d</strong> and their measurements <strong>-f</strong> on a given
network (option <strong>-n</strong>).</p>
<p>Flowrouter works by solving a maximum flow problem in the given network
assuming the measured flows as capacity. The input data is by default
aggregated over the whole file but can be split into intervals by
setting <strong>-i</strong> as time <strong>in minutes</strong>. Example call for hourly aggregation:</p>
<pre><code>&lt;SUMO_HOME&gt;/tools/detector/flowrouter.py -n input_net.net.xml -d detectors.xml -f flows20140520.csv -o routes.xml -e flows.xml -i 60
</code></pre>
<p>Detectors which have no data (in the specified interval) or are
permanently zero are ignored by default. To include them into the
calculations use <strong>--respect-zero</strong>.</p>
<p>For additional parameters call</p>
<pre><code>&lt;SUMO_HOME&gt;/tools/detector/flowrouter.py --help
</code></pre>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>flowrouter.py is under continuous development. If it fails to deliver the expected results, try using the <a href="../../Downloads/#sumo_-_latest_development_version">latest development version</a>.</p>
</div>
<h2 id="input-files">Input files<a class="headerlink" href="#input-files" title="Permanent link">&para;</a></h2>
<p>The traffic flow file is described in the corresponding <a href="../../Demand/Routes_from_Observation_Points/#computing_flows">dfrouter documentation</a>.</p>
<p>As detector file input you can either use</p>
<ul>
<li>The detector file as described in the <a href="../../Demand/Routes_from_Observation_Points/#computing_detector_types">dfrouter documentation</a></li>
<li>A detector file with types as <a href="../../Demand/Routes_from_Observation_Points/#computing_detector_types">generated by dfrouter</a></li>
<li>a file with <a href="../../Simulation/Output/Induction_Loops_Detectors_%28E1%29/">induction loop definitions</a></li>
</ul>
<p>When loading a detector file without <code>type</code> information or setting the option <strong>--revalidate-detectors</strong>, all network edges will be re-classified as <em>sources</em>, <em>sinks</em> or
<em>in-between</em>.</p>
<ul>
<li>any edge without incoming edges will be marked as a source</li>
<li>any edge without outgoing edges will be marked as a sink</li>
<li>any edge that is neither source or sink is <em>in-between</em></li>
</ul>
<h2 id="generating-vehicles-with-additional-parameters">Generating vehicles with additional parameters<a class="headerlink" href="#generating-vehicles-with-additional-parameters" title="Permanent link">&para;</a></h2>
<p>With the option <strong>--params</strong> <a href="/Basics/Notation/#データタイプ"><em>&lt;STRING&gt;</em></a>, additional parameters can be given to the generated
vehicles (note, usage of the quoting characters).</p>
<pre><code>&lt;SUMO_HOME&gt;/tools/detector/flowrouter.py -n input_net.net.xml --params=&quot;departLane=\&quot;best\&quot; departSpeed=\&quot;max\&quot; type=\&quot;myType&quot;&quot;
</code></pre>
<p>This would insert the vehicle with high speed on a reasonable lane. The
vehicles would be defined with type <em>myType</em> (which could also be the
name of a typeDistribution).</p>
<h2 id="ambiguity">Ambiguity<a class="headerlink" href="#ambiguity" title="Permanent link">&para;</a></h2>
<p>In many cases, the solutions for a given input is not unique. It is often the case, that a large proportion of the solution space contains "implausible" (i.e. looped / detour) routes. Some strategies for mitigation are described below. In some cases it may be better to use the <a href="../../Demand/Routes_from_Observation_Points/#choosing_the_right_tool">routeSampler tool instead</a>.</p>
<h3 id="distribution-among-candidate-successors">Distribution among candidate successors<a class="headerlink" href="#distribution-among-candidate-successors" title="Permanent link">&para;</a></h3>
<p>By setting the option <strong>--limit</strong> <a href="/Basics/Notation/#データタイプ"><em>&lt;INT&gt;</em></a>, the flow is assigned in multiple iterations. This can increase running time but causes
flows to be distributed more evenly so that all routes are used in
proportion to the incoming and outgoing flows (similar to the behavior of
<a href="../../dfrouter/">dfrouter</a>).</p>
<h3 id="restricting-generated-routes">Restricting generated routes<a class="headerlink" href="#restricting-generated-routes" title="Permanent link">&para;</a></h3>
<p>With the option <strong>--flow-restrictions</strong> <a href="/Basics/Notation/#データタイプ"><em>&lt;FILE&gt;</em></a>, flow restriction for routes may be given. Each line in the input file takes the form:</p>
<pre><code>&lt;FLOW1&gt; &lt;EDGE1&gt; &lt;EDGE2&gt; ... &lt;EDGEk&gt;
</code></pre>
<p>This specifies the maximum flow for a route that consists of the given
edges. Alternatively, the flow for a single edge can be restricted with an input line:</p>
<pre><code>&lt;FLOW1&gt; &lt;EDGE1&gt;
</code></pre>
<p>The tool <a href="../Routes/#implausibleroutespy">implausibleRoutes.py</a> can be used to generate restrictions for routes that are implausible according to a configurable heuristic.</p>
<h1 id="flowfromroutespy">flowFromRoutes.py<a class="headerlink" href="#flowfromroutespy" title="Permanent link">&para;</a></h1>
<p>This script does the reverse of flowrouter.py and
<a href="../../dfrouter/">dfrouter</a> in generating a traffic counts for
detectors from a route or flow file. Its main purpose: It can also be used to compare the
input counts with the outputs of flowrouter.py and
<a href="../../dfrouter/">dfrouter</a>. Example:</p>
<pre><code>&lt;SUMO_HOME&gt;/tools/detector/flowFromRoutes.py -d detectors.xml -r routes.xml -e flows.xml
</code></pre>
<h1 id="flowfromedgedata">flowFromEdgeData<a class="headerlink" href="#flowfromedgedata" title="Permanent link">&para;</a></h1>
<p>This script is similar to <a href="#flowfromroutespy">flowFromRoutes.py</a>. It generates traffic counts for detectors but uses <a href="../../Simulation/Output/Lane-_or_Edge-based_Traffic_Measures/">edgeData files</a> as input instead of routes.
It requires the use of an input flow file and then performs a comparison between input flows and edgdata flows</p>
<pre><code>&lt;SUMO_HOME&gt;/tools/detector/flowFromEdgeData.py -d detectors.xml -e edgedata.xml -f flows.txt
</code></pre>
<h1 id="edgedatafromflowpy">edgeDataFromFlow.py<a class="headerlink" href="#edgedatafromflowpy" title="Permanent link">&para;</a></h1>
<p>This script converts <a href="../../Demand/Routes_from_Observation_Points/#computing_flows">detector flow files</a> to into <a href="../../Simulation/Output/Lane-_or_Edge-based_Traffic_Measures/#edge-based_network_states">edgeData format</a> (i.e. to be used by <a href="../Turns/#edge_counts">routeSampler.py</a> or for <a href="../../sumo-gui/#visualizing_edge-related_data">visualization in sumo-gui</a>)
Example:</p>
<pre><code>&lt;SUMO_HOME&gt;/tools/detector/edgeDataFromFlow.py -d input_detectors.det.xml -f input_flows.txt -o edgedata.xml
</code></pre>
<h1 id="filterflowspy">filterFlows.py<a class="headerlink" href="#filterflowspy" title="Permanent link">&para;</a></h1>
<p>Filters a flow file by detector ids and time range</p>
<pre><code>&lt;SUMO_HOME&gt;/tools/detector/edgeDataFromFlow.py -d det1,det2 -f input_flows.txt -b 3600 -e 7200 -o output_flows.txt
</code></pre>
<h1 id="mapdetectorspy">mapDetectors.py<a class="headerlink" href="#mapdetectorspy" title="Permanent link">&para;</a></h1>
<p>Given a file <code>det.csv</code> of the following form</p>
<pre><code>id;lat;lon
det1;52.432559;13.496612
det2;52.432373;13.496142
</code></pre>
<p>It can be turned into a file with detectors with:</p>
<pre><code>&lt;SUMO_HOME&gt;/tools/detector/mapDetectors.py -n net.net.xml -d  det.csv -o det.add.xml
</code></pre>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version": "\u30d0\u30fc\u30b8\u30e7\u30f3\u5207\u308a\u66ff\u3048"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>
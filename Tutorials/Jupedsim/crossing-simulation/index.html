
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://kudzuyu.github.io/SUMO-wiki-ja/Tutorials/Jupedsim/crossing-simulation/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Crossing Simulation - SUMO wiki ja</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
      <link rel="stylesheet" href="//fonts.googleapis.com/earlyaccess/notosansjp.css">
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:600,800">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#setting-up-the-network" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../../.." title="SUMO wiki ja" class="md-header__button md-logo" aria-label="SUMO wiki ja" data-md-component="logo">
      
  <img src="../../../images/sumo-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SUMO wiki ja
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Crossing Simulation
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="検索">
        
        <button type="reset" class="md-search__icon md-icon" title="クリア" aria-label="クリア" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="タブ" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  ドキュメント

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../Downloads/" class="md-tabs__link">
        
  
  
    
  
  ダウンロード

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../Publications/" class="md-tabs__link">
        
  
  
    
  
  出版物

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="SUMO wiki ja" class="md-nav__button md-logo" aria-label="SUMO wiki ja" data-md-component="logo">
      
  <img src="../../../images/sumo-logo.png" alt="logo">

    </a>
    SUMO wiki ja
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ドキュメント
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Downloads/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ダウンロード
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Publications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    出版物
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setting-up-the-network" class="md-nav__link">
    <span class="md-ellipsis">
      Setting up the Network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-the-demand" class="md-nav__link">
    <span class="md-ellipsis">
      Setting up the Demand
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setting up the Demand">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vehicle-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Vehicle Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#person-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Person Flow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-with-striping-model" class="md-nav__link">
    <span class="md-ellipsis">
      Run with Striping Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-with-jupedsim-model" class="md-nav__link">
    <span class="md-ellipsis">
      Run with JuPedSim Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      Results
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Crossing Simulation</h1>

<p>In this tutorial you will learn how to configure a basic simulation scenario with <em>netedit</em> from scratch.
The scenario consists of crossing with interacting cars and pedestrians.
We will define the simulation network and the demand for vehicle and person flows.
First, you will run a simulation with the default pedestrian model of <em>SUMO</em> (<a href="../../../Simulation/Pedestrians/#model_striping">striping model</a>).
Then you will switch to the <em>JuPedSim</em> model and inspect the results.
At the end of this tutorial, you can find videos of the simulation results for both models.</p>
<p>You can find the resulting <strong>configuration files</strong> for this tutorial <a href="https://github.com/PedestrianDynamics/SUMO-JuPedSim-Simulations/tree/main/tutorials/crossing">here</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you made a mistake press <kbd>Ctrl</kbd> + <kbd>Z</kbd> to undo the last step.</p>
</div>
<p>The message window at the bottom of <em>netedit</em> informs you about warnings and errors. For this tutorial, the window was hidden.</p>
<h2 id="setting-up-the-network">Setting up the Network<a class="headerlink" href="#setting-up-the-network" title="Permanent link">&para;</a></h2>
<p>Open <em>netedit</em> and create a new network by clicking on <em>File &gt; New Network</em>.
Now you are in the <strong>Network supermode</strong> and can draw the roads for the crossing.
By default the <em>Edge mode</em> is activated.
To draw two-way roads enable the <em>Edge opposite direction</em> on the right side of the toolbar.
Then you can draw the edges (roads) in the editor.</p>
<p><img alt="*Edge mode* for creating the network" src="../../../images/network_edges1.png" /></p>
<p>Make sure that the edges are connected by a node in the center so that a crossing can be generated.
To learn more about the <em>SUMO</em> road network we refer to <a href="../../../Networks/SUMO_Road_Networks/">this</a> website.</p>
<p>As pedestrians are spawned distributed along an edge we define small edges at the end of the roads of interest.
In this way, we reduce the effects of the initial conditions and the pedestrians are already in motion when they enter the network defined above.
To compute junctions press <em>F5</em> or click <em>Processing &gt; Compute Junctions</em>.</p>
<p><img alt="Adapted network for spawning and removing agents" src="../../../images/network_edges2.png" /></p>
<p>Now we add sidewalks for the pedestrians to our network.
For this, we enable the <em>Select Mode</em>.
In the selection menu on the left choose <em>Apply selection</em> for the specified match attributes.
The selected edges are highlighted in blue.</p>
<p><img alt="Network with selected edges" src="../../../images/network_select.png" /></p>
<p>Then right click on the selected edges <em>Lane operations &gt; Add restricted lane &gt; Sidewalk</em> and confirm the operation as shown here:</p>
<p><img alt="Adding a sidewalk to each edge" src="../../../images/network_sidewalk.png" /></p>
<p>For each road a sidewalk is created.
Clear the selection by pressing <em>ESC</em> and compute the junctions again (press <em>F5</em>).
The network should look like this:</p>
<p><img alt="Final egdes" src="../../../images/network_edges_final.png" /></p>
<p>Now we add a traffic light.
Switch to <em>Traffic light mode</em> and select the junction in the middle of the network.
Then click on <em>Create</em> in the left menu.</p>
<p><img alt="*Traffic light mode*" src="../../../images/network_traffic_lights1.png" /><img alt="Network with traffic lights" src="../../../images/network_traffic_lights2.png" /></p>
<p>Now we configure the crossing options for pedestrians.
Enable the <em>Crossing mode</em> and click on the junction.
Select the pair of roads that should be connected by a crosswalk and press <em>Enter</em>.
Possible candidates are highlighted in dark green.
Once you have selected a candidate (light green) the matching one is restricted to the neighbored lane.</p>
<p><img alt="Adding crossings to the junction" src="../../../images/network_crossing2.png" /></p>
<p>In this example, pedestrians are allowed to cross the junction on all roads.
So you have to repeat this process for the three remaining roads.</p>
<p>You have finished the configuration of the network.
Save the network file by clicking <em>Save network</em> in the toolbar on the left.
In this example, the file is named <em>crossing.net.xml</em>.</p>
<p><img alt="Final network file" src="../../../images/network_final.png" /></p>
<h2 id="setting-up-the-demand">Setting up the Demand<a class="headerlink" href="#setting-up-the-demand" title="Permanent link">&para;</a></h2>
<p>Next, we configure the flow of cars and pedestrians at the border of the defined crossing.</p>
<h3 id="vehicle-flow">Vehicle Flow<a class="headerlink" href="#vehicle-flow" title="Permanent link">&para;</a></h3>
<p>We start with the vehicles.
Switch to the <strong>Demand supermode</strong> and enable the <em>Vehicle mode</em>.
As we want to create a flow of vehicles, you need to choose the option <em>flow (from-to edges)</em> at the top of the menu on the left.
You can define properties of the flow when you scroll down the menu.
We define that a car should appear every 30 seconds.</p>
<p><img alt="*Vehicle mode* for configuration of vehicle flows" src="../../../images/demand_vehicle1.png" /></p>
<p>Now you can define the route for that flow by clicking on the edge where the flow should start.
If you scroll down on the left, you can see information on the coloring of the edges in the defined network.
Select the edges you want to connect and click on <em>Finish route creation</em> in the menu on the left.</p>
<p><img alt="Route creation for vehicles" src="../../../images/demand_vehicle2.png" /></p>
<p>We create a second flow and define a route starting from a different edge.
By default, this flow has the same properties as the previously defined flow - we keep the same attributes.
We switch to <em>Inspect mode</em> and click on a vehicle to check its attributes and route.
This way you can modify the attributes after creating elements.</p>
<p><img alt="Inspect created vehicle flows" src="../../../images/demand_vehicle3.png" /></p>
<h3 id="person-flow">Person Flow<a class="headerlink" href="#person-flow" title="Permanent link">&para;</a></h3>
<p>Next, we add pedestrian flows to the scenario.
Click on the <em>Person mode</em> and choose the <em>personFlow</em> on the top of the menu on the left.
We choose <em>red</em> as the color for the first flow.
For <em>departPos</em> type in <em>random</em> so that the pedestrians are distributed on different positions along the edge.
The spawning period is set to 4 seconds.</p>
<p><img alt="*Person mode* for configuration of person flows" src="../../../images/demand_person1.png" /></p>
<p>As plan type we use the default <em>PersonTrip</em>.
Scroll down to the <em>Route creator</em> in the menu on the left.
Now we can plan the route as for the vehicle flow.
Click on an edge where the pedestrians should be spawned and click on the destination edge. Do not forget to click on <em>Finish route creation</em>.</p>
<p><img alt="Route creation for person flows" src="../../../images/demand_person2.png" /></p>
<p>We add more flows starting from different edges.
In this example, we define two flows that are moving towards each other (red and green) and one additional flow, that is crossing from above (blue).
We save the demand file named as <em>crossing.rou.xml</em>.</p>
<p><img alt="Save the final demand configuration" src="../../../images/demand_person3.png" /></p>
<h2 id="run-with-striping-model">Run with Striping Model<a class="headerlink" href="#run-with-striping-model" title="Permanent link">&para;</a></h2>
<p>Next, we start the simulation with the default settings.
To do so open the simulation configuration in <em>sumo-gui</em> as shown here:</p>
<p><img alt="Open *sumo-gui*" src="../../../images/gui_open.png" /></p>
<p><em>netedit</em> asks for saving the sumoconfig file.
After saving the file as <em>crossing.sumocfg</em>, a new window in <em>sumo-gui</em> is opened.
Before pressing <em>Run</em> increase the <em>Delay</em> (as the simulation is performed very quickly)  and adapt the visualization as you wish.
We choose <em>triangles</em> as a visualization for the pedestrians.
This option can be found by clicking on <em>Edit Coloring Schemes</em> (color wheel) and then go to <em>Persons</em>.</p>
<p><img alt="Settings of *sumo-gui*" src="../../../images/gui_settings.png" /></p>
<p>When zooming in you can see interacting cars and pedestrian at the crossing.
For this simulation the <em>striping</em> model is used.
As you can see the pedestrians are moving and waiting in structured formations.</p>
<p><img alt="Snapshot of simulation with *striping* model" src="../../../images/gui_snapshot_striping.png" /></p>
<h2 id="run-with-jupedsim-model">Run with JuPedSim Model<a class="headerlink" href="#run-with-jupedsim-model" title="Permanent link">&para;</a></h2>
<p>Now we want to use the <em>JupedSim</em> model instead.
For this, we open <em>nededit</em> again and change the configuration options by clicking on <em>Processing &gt; Sumo options</em>.
An new window is opened.
Search for <em>model</em> and type in <em>jupedsim</em> as a pedestrian model.</p>
<p><img alt="Configuration of simulation options" src="../../../images/sumo_options1.png" /></p>
<p>The <em>JuPedSim</em> routing differs from the usual <em>SUMO</em> routing.
Edges within the walkable area do not necessarily have to be connected to each other.
Therefore, we ignore route errors.
Enable this function as shown here:</p>
<p><img alt="Further configuration of simulation options" src="../../../images/sumo_options2.png" /></p>
<p>Press <em>OK</em>, save the sumoconfig file and open the simulation scenario in <em>sumo-gui</em> again.
The walkable area is shown in light blue now.
Your simulation should look similar to this one:</p>
<p><img alt="Snapshot of simulation with *JuPedSim* model" src="../../../images/gui_snapshot_jupedsim.png" /></p>
<h2 id="results">Results<a class="headerlink" href="#results" title="Permanent link">&para;</a></h2>
<p>In the following, you can see a comparison of the two simulations results (left: <em>striping</em> model, right: <em>JuPedSim</em> model).
There are clear differences in the movement patterns and interactions as the <em>JuPedSim</em> pedestrians are moving in 2D space.</p>
<table>
<thead>
<tr>
<th><img alt="image" src="../../../images/simulation_striping.gif" /></th>
<th><img alt="image" src="../../../images/simulation_jupedsim.gif" /></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version": "\u30d0\u30fc\u30b8\u30e7\u30f3\u5207\u308a\u66ff\u3048"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>